
> codex-session-viewer@0.1.0 test
> vitest run


 RUN  v2.1.9 /home/user/projects/codex-session-viewer

 ✓ src/utils/__tests__/functionFilters.test.ts (2 tests) 2ms
 ✓ src/parsers/__tests__/applyPatch.test.ts (3 tests) 3ms
 ✓ src/parser/__tests__/streaming.test.ts (2 tests) 10ms
 ✓ src/parser/__tests__/lineReader.test.ts (3 tests) 9ms
 ✓ src/parser/__tests__/validators.test.ts (3 tests) 4ms
 ❯ src/components/__tests__/applyPatchView.test.ts (1 test | 1 failed) 9ms
   × ApplyPatchView (SSR snapshot) > renders header and raw toggle for a simple update patch 8ms
     → document is not defined
 ✓ src/utils/__tests__/fileTree.test.ts (3 tests) 3ms
 ✓ src/utils/__tests__/diff.test.ts (3 tests) 4ms
 ✓ src/utils/timestamp.test.ts (5 tests) 3ms
 ✓ src/components/__tests__/diffTheme.test.ts (3 tests) 2ms
 ✓ src/state/__tests__/theme.test.ts (2 tests) 2ms

⎯⎯⎯⎯⎯⎯⎯ Failed Tests 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/components/__tests__/applyPatchView.test.ts > ApplyPatchView (SSR snapshot) > renders header and raw toggle for a simple update patch
ReferenceError: document is not defined
 ❯ src/components/DiffViewer.tsx:43:85
     41|   const { mode } = useTheme()
     42|   const [editorThemePref, setEditorThemePref] = React.useState<'auto' …
     43|   const monacoTheme = React.useMemo(() => computeMonacoTheme(mode, edi…
       |                                                                                     ^
     44| 
     45|   return (
 ❯ Object.useMemo node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:5128:19
 ❯ Proxy.useMemo node_modules/react/cjs/react.development.js:1650:21
 ❯ DiffViewer src/components/DiffViewer.tsx:43:29
 ❯ renderWithHooks node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:5662:16
 ❯ renderIndeterminateComponent node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:5736:15
 ❯ renderElement node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:5961:7
 ❯ renderNodeDestructiveImpl node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:6119:11
 ❯ renderNodeDestructive node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:6091:14
 ❯ renderNode node_modules/react-dom/cjs/react-dom-server-legacy.node.development.js:6274:12

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯

 Test Files  1 failed | 10 passed (11)
      Tests  1 failed | 29 passed (30)
   Start at  11:25:36
   Duration  1.02s (transform 184ms, setup 0ms, collect 361ms, tests 49ms, environment 291ms, prepare 498ms)

